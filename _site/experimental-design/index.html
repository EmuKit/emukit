<!DOCTYPE html> <html> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.5.0 --> <title>Experimental design | Emukit</title> <meta name="generator" content="Jekyll v3.8.5" /> <meta property="og:title" content="Experimental design" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Experimental design addresses the problem of how to collect data points (experiments) to better control certain sources of variance of a model." /> <meta property="og:description" content="Experimental design addresses the problem of how to collect data points (experiments) to better control certain sources of variance of a model." /> <link rel="canonical" href="http://localhost:4000/emukit/experimental-design/" /> <meta property="og:url" content="http://localhost:4000/emukit/experimental-design/" /> <meta property="og:site_name" content="Emukit" /> <meta property="og:type" content="article" /> <meta property="article:published_time" content="2016-06-09T00:00:00+01:00" /> <meta name="twitter:card" content="summary" /> <meta name="twitter:site" content="@" /> <script type="application/ld+json"> {"url":"http://localhost:4000/emukit/experimental-design/","dateModified":"2016-06-09T00:00:00+01:00","datePublished":"2016-06-09T00:00:00+01:00","headline":"Experimental design","description":"Experimental design addresses the problem of how to collect data points (experiments) to better control certain sources of variance of a model.","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/emukit/experimental-design/"},"@type":"BlogPosting","@context":"http://schema.org"}</script> <!-- End Jekyll SEO tag --> <!-- <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"> --> <link rel="stylesheet" href="/emukit/css/main.css"> <link rel="alternate" type="application/rss+xml" title="Emukit" href="http://localhost:4000/emukit/feed.xml"> <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"> </head> <body> <header class="site-header"> <nav class="navbar navbar-default"> <div class="container-fluid"> <!-- Brand and toggle get grouped for better mobile display --> <div class="navbar-header"> <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button> <a class="navbar-brand" href="/emukit/">Emukit</a> </div> <!-- Collect the nav links, forms, and other content for toggling --> <div class="collapse navbar-collapse " id="bs-example-navbar-collapse-1"> <ul class="nav navbar-nav navbar-right"> <li><a href="/emukit/about/">About</a></li> <li><a href="http://nbviewer.jupyter.org/github/amzn/emukit/blob/develop/notebooks/index.ipynb">Tutorials</a></li> <li><a href="https://github.com/amzn/emukit/tree/develop/emukit/examples">Examples</a></li> <li class="dropdown"> <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Resources<span class="caret"></span></a> <ul class="dropdown-menu"> <li><a href="/emukit/installation/">Installation</a></li> <li role="separator" class="divider"></li> <li><a href="https://emukit.readthedocs.io/en/latest/">Documentation</a></li> <li><a href="https://emukit.readthedocs.io/en/latest/api/emukit.html">API reference</a></li> <li role="separator" class="divider"></li> <li><a href="/emukit/citation/">Citation</a></li> <li><a href="/emukit/news/">News</a></li> </ul> <li><a href="https://github.com/amzn/emukit">Github</a></li> </li> </ul> </div><!-- /.navbar-collapse --> </div><!-- /.container-fluid --> </nav> </header> <div class="container"> <div class="wrapper"> <div class="row"> <div class="col-md-8"> <article class="post" itemscope itemtype="http://schema.org/BlogPosting"> <header class="post-header"> <h1 class="post-title" itemprop="name headline">Experimental design</h1> <p class="post-meta"></p> </header> <div class="post-content" itemprop="articleBody"> <p>Experimental design addresses the problem of how to collect data points (experiments) to better control certain sources of variance of a model.</p> <p>In experimental design the goal is to decide at which locations of the input space we should evaluate a function of interest. In some contexts it is also known as active learning, for instance in image classification problems in which more labels need to be collected.</p> <p>The are two main ways of doing experimental design.</p> <ul> <li> <p><em>Model-free designs:</em> These designs define rules to spread the experiments as much as possible across the input domain. Drawing points at random or in a grid are the most naive way of doing so. Other more elaborate approaches are <a href="https://en.wikipedia.org/wiki/Low-discrepancy_sequence">low discrepancy sequences</a> that try to induce some negative correlation in the selected points to spread them evenly. Some examples are Latin hyper-cube sampling and Sobol sequences.</p> </li> <li> <p><em>Model-based designs:</em> In these designs a feedback loop is used between some ‘optimal’ statistical criterion to collect points and a model. In general, the criterion aims to reduce some type of variance in the model. The type of optimality refers to which type of uncertainty that is reduced. For instance, a <em>D-optimal</em> design aims to maximize the differential Shannon information content of the model parameter estimates; an <em>I-optimal</em> design seeks to minimize the average prediction variance over the entire design space. See <a href="#references-on-experimental-design">[1]</a> for a general review on experimental design of these type with Bayesian modes.</p> </li> </ul> <p>Gaussian processes have a long tradition of being the ‘model of choice’ for designing experiments [<a href="#references-on-experimental-design">2</a>]. Next, we explain how you can use them in Emukit for this purpose. Of course you can generalize these ideas to other models too.</p> <p>We start by loading the <a href="https://www.sfu.ca/~ssurjano/branin.html">Branin function</a>. We define the input space to be [-5,10]x[0,15].</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">emukit.test_functions</span> <span class="kn">import</span> <span class="n">branin_function</span>
<span class="kn">from</span> <span class="nn">emukit.core</span> <span class="kn">import</span> <span class="n">ParameterSpace</span><span class="p">,</span> <span class="n">ContinuousParameter</span>

<span class="n">f</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">branin_function</span><span class="p">()</span>
<span class="n">parameter_space</span> <span class="o">=</span> <span class="n">ParameterSpace</span><span class="p">([</span><span class="n">ContinuousParameter</span><span class="p">(</span><span class="s">'x1'</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
                                  <span class="n">ContinuousParameter</span><span class="p">(</span><span class="s">'x2'</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">)])</span>
</code></pre></div></div> <p>Emukit supports both model-free and model-based experimental design strategies. To start, as we don’t have any other information about the function, we first collect 20 points using a Latin design.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">emukit.experimental_design.model_free.latin_design</span> <span class="kn">import</span> <span class="n">LatinDesign</span>

<span class="n">design</span> <span class="o">=</span> <span class="n">LatinDesign</span><span class="p">(</span><span class="n">parameter_space</span><span class="p">)</span> 
<span class="n">num_data_points</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">design</span><span class="o">.</span><span class="n">get_samples</span><span class="p">(</span><span class="n">num_data_points</span><span class="p">)</span>
</code></pre></div></div> <p>Now we evaluate the function at the selected points and we fit a model with <a href="https://github.com/SheffieldML/GPy">GPy</a>.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">GPy.models</span> <span class="kn">import</span> <span class="n">GPRegression</span>
<span class="kn">from</span> <span class="nn">emukit.model_wrappers</span> <span class="kn">import</span> <span class="n">GPyModelWrapper</span>

<span class="n">Y</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">model_gpy</span> <span class="o">=</span> <span class="n">GPRegression</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">)</span>
<span class="n">model_emukit</span> <span class="o">=</span> <span class="n">GPyModelWrapper</span><span class="p">(</span><span class="n">model_gpy</span><span class="p">)</span>
</code></pre></div></div> <p>We can use the model to decide which are the best points to collect using some data collection criteria (that we call acquisition). Here we use the model variance as the acquisition function. It is known that when using Gaussian processes, selecting points of maximum variance is equivalent to maximizing the mutual information between the model and the new set of points [<a href="#references-on-experimental-design">3</a>] so this is a simple but mathematically grounded approach.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">emukit.experimental_design.model_based.acquisitions</span> <span class="kn">import</span> <span class="n">ModelVariance</span>

<span class="n">model_variance</span> <span class="o">=</span> <span class="n">ModelVariance</span><span class="p">(</span><span class="n">model</span> <span class="o">=</span> <span class="n">model_emukit</span><span class="p">)</span>
</code></pre></div></div> <p>As we do in other parts of Emukit, we can put our Gaussian process model to work in a data collection loop. In this case we define experiments in which 5 points are collected in parallel.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">emukit.experimental_design.model_based</span> <span class="kn">import</span> <span class="n">ExperimentalDesignLoop</span>

<span class="n">expdesign_loop</span> <span class="o">=</span> <span class="n">ExperimentalDesignLoop</span><span class="p">(</span><span class="n">model</span> <span class="o">=</span> <span class="n">model_emukit</span><span class="p">,</span>
                                         <span class="n">space</span> <span class="o">=</span> <span class="n">parameter_space</span><span class="p">,</span>
                                         <span class="n">acquisition</span> <span class="o">=</span> <span class="n">model_variance</span><span class="p">,</span>
                                         <span class="n">batch_size</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
</code></pre></div></div> <p>By passing the function to evaluate, for instance if we are running experiments with a simulator, we can totally automate the data collection process. Let’s run 10 experiments with 5 points each.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">max_iterations</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">expdesign_loop</span><span class="o">.</span><span class="n">run_loop</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">max_iterations</span><span class="p">)</span>
</code></pre></div></div> <p>If you are running physical experiments you can just run one iteration, collect the 5 points and repeat the process over for the next batch.</p> <p>Check our list of <a href="http://nbviewer.jupyter.org/github/amzn/emukit/blob/develop/notebooks/index.ipynb">notebooks</a> and <a href="https://github.com/amzn/emukit/tree/develop/emukit/examples">examples</a> if you want to learn more about how to do experimental design and other methods with Emukit. You can also check the Emukit <a href="https://emukit.readthedocs.io/en/latest/">documentation</a>.</p> <p>We’re always open to contributions! Please read our <a href="https://github.com/amzn/emukit/blob/develop/CONTRIBUTING.md">contribution guidelines</a> for more information. We are particularly interested in contributions regarding examples and tutorials.</p> <h4 id="references-on-experimental-design">References on experimental design</h4> <ul> <li> <p>[1] Kathryn Chaloner and Isabella Verdinelli, (1995). <a href="https://www.jstor.org/stable/2246015?seq=1#page_scan_tab_contents">Bayesian Experimental Design: A Review</a>, <em>Statistical Science</em> Vol. 10, No. 3, pp. 273-304, 1995.</p> </li> <li> <p>[2] Jerome Sacks, William J Welch, Toby J Mitchell and Henry P Wynn (1989). <a href="https://projecteuclid.org/euclid.ss/1177012413">Design and analysis of computer experiments</a>, Statistical science, Vol. 4, No. 4, pp. 409-423, 1989.</p> </li> <li> <p>[3] Niranjan Srinivas, Andreas Krause, Sham Kakade, Matthias Seeger - <a href="http://www-stat.wharton.upenn.edu/~skakade/papers/ml/bandit_GP_icml.pdf">Gaussian process optimization in the bandit setting: No regret and experimental design</a>, <em>Proceedings of the 27 th International Conference on Machine Learning</em>, Haifa, Israel, 2010.</p> </li> </ul> </div> </article> <div class="row"> </div> <div class="row"> <ul class="pager"> <li><a class="next" href="/emukit/multifidelity-emulation/">&laquo; Multi-fidelity emulation</a></li> <li><a class="previous" href="/emukit/bayesian-quadrature/">Bayesian Quadrature &raquo;</a></li> </ul> </div> </div> <div class="col-md-4 mt20"> <div class="post-img"> <img width="600" src="/emukit/images/experimental-design.png" alt="Experimental design"> </div> <div class="mt10 recent"> <h2>Also in Emukit</h2> <ul> <li> <p><a href="/emukit/emukit-playground/">Emukit-playground</a></p> </li> <li> <p><a href="/emukit/bayesian-optimization/">Bayesian Optimization</a></p> </li> <li> <p><a href="/emukit/multifidelity-emulation/">Multi-fidelity emulation</a></p> </li> </ul> </div> </div> </div> </div> </div> <footer> <div class="container"> <div class="row p20"> <div class="col-md-4 text-center mt25"> <a target="_blank" href="http://twitter.com/@emukitUQ"><li class="social twitter"><i class="fa fa-twitter-square"></i></li></a> <a target="_blank" href="https://github.com/amzn/emukit"><li class="social github"><i class="fa fa-github-square"></i></li></a> </div> </div> </div> </footer> <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.2/jquery.min.js"></script> <script src="/emukit/js/bootstrap.min.js"></script> <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> </body> </html>
