<!DOCTYPE html> <html> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.5.0 --> <title>Multi-fidelity emulation | Emukit</title> <meta name="generator" content="Jekyll v3.8.5" /> <meta property="og:title" content="Multi-fidelity emulation" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Use Emukit to build emulators in scenarios where data of different levels of accuracy are available. Use this models in decision loops." /> <meta property="og:description" content="Use Emukit to build emulators in scenarios where data of different levels of accuracy are available. Use this models in decision loops." /> <link rel="canonical" href="http://localhost:4000/emukit/multifidelity-emulation/" /> <meta property="og:url" content="http://localhost:4000/emukit/multifidelity-emulation/" /> <meta property="og:site_name" content="Emukit" /> <meta property="og:type" content="article" /> <meta property="article:published_time" content="2016-06-10T00:00:00+01:00" /> <meta name="twitter:card" content="summary" /> <meta name="twitter:site" content="@" /> <script type="application/ld+json"> {"url":"http://localhost:4000/emukit/multifidelity-emulation/","dateModified":"2016-06-10T00:00:00+01:00","datePublished":"2016-06-10T00:00:00+01:00","headline":"Multi-fidelity emulation","description":"Use Emukit to build emulators in scenarios where data of different levels of accuracy are available. Use this models in decision loops.","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/emukit/multifidelity-emulation/"},"@type":"BlogPosting","@context":"http://schema.org"}</script> <!-- End Jekyll SEO tag --> <!-- <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"> --> <link rel="stylesheet" href="/emukit/css/main.css"> <link rel="alternate" type="application/rss+xml" title="Emukit" href="http://localhost:4000/emukit/feed.xml"> <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"> </head> <body> <header class="site-header"> <nav class="navbar navbar-default"> <div class="container-fluid"> <!-- Brand and toggle get grouped for better mobile display --> <div class="navbar-header"> <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button> <a class="navbar-brand" href="/emukit/">Emukit</a> </div> <!-- Collect the nav links, forms, and other content for toggling --> <div class="collapse navbar-collapse " id="bs-example-navbar-collapse-1"> <ul class="nav navbar-nav navbar-right"> <li><a href="/emukit/about/">About</a></li> <li><a href="http://nbviewer.jupyter.org/github/amzn/emukit/blob/develop/notebooks/index.ipynb">Tutorials</a></li> <li><a href="https://github.com/amzn/emukit/tree/develop/emukit/examples">Examples</a></li> <li class="dropdown"> <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Resources<span class="caret"></span></a> <ul class="dropdown-menu"> <li><a href="/emukit/installation/">Installation</a></li> <li role="separator" class="divider"></li> <li><a href="https://emukit.readthedocs.io/en/latest/">Documentation</a></li> <li><a href="https://emukit.readthedocs.io/en/latest/api/emukit.html">API reference</a></li> <li role="separator" class="divider"></li> <li><a href="/emukit/citation/">Citation</a></li> <li><a href="/emukit/news/">News</a></li> </ul> <li><a href="https://github.com/amzn/emukit">Github</a></li> </li> </ul> </div><!-- /.navbar-collapse --> </div><!-- /.container-fluid --> </nav> </header> <div class="container"> <div class="wrapper"> <div class="row"> <div class="col-md-8"> <article class="post" itemscope itemtype="http://schema.org/BlogPosting"> <header class="post-header"> <h1 class="post-title" itemprop="name headline">Multi-fidelity emulation</h1> <p class="post-meta"></p> </header> <div class="post-content" itemprop="articleBody"> <p>Use Emukit to build emulators in scenarios where data of different levels of accuracy are available. Use this models in decision loops.</p> <p>A common issue encountered when applying machine learning to environmental sciences and engineering problems is the difficulty or cost required to obtain sufficient data for building robust models. Possible examples include aerospace and nautical engineering, where it is both infeasible and prohibitively expensive to run a vast number of experiments using the actual vehicle. Even when there is no physical artifact involved, such as in climate modeling, data may still be hard to obtain when these can only be collected by running an expensive computer experiment, where the time required to acquire an individual data sample restricts the volume of data that can later be used for modeling.</p> <p>Constructing a reliable model when only few observations are available is challenging, which is why it is common practice to develop simulators of the actual system, from which data points can be more easily obtained. In engineering applications, such simulators often take the form of <a href="https://en.wikipedia.org/wiki/Computational_fluid_dynamics">Computational Fluid Dynamics</a> tools which approximate the behaviour of the true artifact for a given design or configuration. However, although it is now possible to obtain more data samples, it is highly unlikely that these simulators model the true system exactly; instead, these are expected to contain some degree of bias and/or noise.</p> <p>Naively combining observations from multiple information sources could result in the model giving biased predictions which do not accurately reflect the true problem. To this end, multi-fidelity models are designed to augment the limited true observations available with cheaply-obtained approximations in a principled manner. In such models, observations obtained from the true source are referred to as high-fidelity observations, whereas approximations are denoted as being low-fidelity. These low-fidelity observations are then systemically combined with the more accurate (but limited) observations in order to predict the high-fidelity output more effectively.</p> <p>Emukit offers implementation of a selection Gaussian process multi-fidelity models that can also be combined with other outer-loop applications. To work with an specific example we start loading a problem with two fidelities in which their relationship between is linear. You can check [<a href="#references-on-multi-fidelity-gaussian-processes">1</a>] for a graphical representation of this problem. We will use the interval [0,1] as the input domain in our experiment.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">emukit.emukit.test_functions.forrester</span> <span class="kn">import</span> <span class="n">forrester</span><span class="p">,</span> <span class="n">forrester_low</span>

<span class="n">x_train_l</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_2d</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span><span class="o">.</span><span class="n">T</span>
<span class="n">x_train_h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_2d</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span><span class="n">x_train_l</span><span class="p">)[:</span><span class="mi">6</span><span class="p">])</span>
<span class="n">y_train_l</span> <span class="o">=</span> <span class="n">forrester_low</span><span class="p">(</span><span class="n">x_train_l</span><span class="p">)</span>
<span class="n">y_train_h</span> <span class="o">=</span> <span class="n">forrester</span><span class="p">(</span><span class="n">x_train_h</span><span class="p">)</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span> <span class="o">=</span> <span class="n">convert_xy_lists_to_arrays</span><span class="p">([</span><span class="n">x_train_l</span><span class="p">,</span> <span class="n">x_train_h</span><span class="p">],</span> <span class="p">[</span><span class="n">y_train_l</span><span class="p">,</span> <span class="n">y_train_h</span><span class="p">])</span>
</code></pre></div></div> <p>With this code we have just collected some samples in both fidelities and formatted the data in a way that can be understood by Emukit. Emukit expects the final column of the model inputs to contain an index which indicates which fidelity the point belongs to. Normally, high fidelities are more expensive to sample than low fidelities so we have reflected that in the data collection approach.</p> <p>Now that we have the data, it is time to show how to use Emukit to train a Gaussian process <em>linear</em> multi-fidelity model as proposed in <a href="#references-on-multi-fidelity-gaussian-processes">[3]</a>. A non-linear version of this model proposed in <a href="#references-on-multi-fidelity-gaussian-processes">[3]</a> is also available. The linear model assumes that the high fidelity is a linear combination of the low fidelity and a <em>delta</em> term that captures the difference between the two. We just need to specify the kernels for the two fidelities and create the model. <a href="https://github.com/SheffieldML/GPy">GPy</a> is used as the modelling framework in this example.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">GPy</span>
<span class="kn">from</span> <span class="nn">emukit.multi_fidelity.kernels</span> <span class="kn">import</span> <span class="n">LinearMultiFidelityKernel</span>
<span class="kn">from</span> <span class="nn">emukit.multi_fidelity.models</span> <span class="kn">import</span> <span class="n">GPyLinearMultiFidelityModel</span>

<span class="n">num_fidelities</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">kernels</span> <span class="o">=</span> <span class="p">[</span><span class="n">GPy</span><span class="o">.</span><span class="n">kern</span><span class="o">.</span><span class="n">RBF</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">GPy</span><span class="o">.</span><span class="n">kern</span><span class="o">.</span><span class="n">RBF</span><span class="p">(</span><span class="mi">1</span><span class="p">)]</span>
<span class="n">linear_mf_kernel</span> <span class="o">=</span> <span class="n">LinearMultiFidelityKernel</span><span class="p">(</span><span class="n">kernels</span><span class="p">)</span>
<span class="n">gpy_linear_mf_model</span> <span class="o">=</span> <span class="n">GPyLinearMultiFidelityModel</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">,</span> <span class="n">linear_mf_kernel</span><span class="p">,</span> <span class="n">n_fidelities</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
</code></pre></div></div> <p>We have created the model. The last step is to train it. As the evaluations of the fidelities are exact, we first set the noise parameters to zero by doing</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">gpy_linear_mf_model</span><span class="o">.</span><span class="n">mixed_noise</span><span class="o">.</span><span class="n">Gaussian_noise</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">gpy_linear_mf_model</span><span class="o">.</span><span class="n">mixed_noise</span><span class="o">.</span><span class="n">Gaussian_noise_1</span><span class="o">.</span><span class="n">fix</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div></div> <p>and complete the training by optimizing the model</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">gpy_linear_mf_model</span><span class="o">.</span><span class="n">optimize</span><span class="p">()</span>
</code></pre></div></div> <p>If you are planning to use the model in a loop (like Bayesian optimization or experimental design) you can load the <code class="highlighter-rouge">GPyMultiOutputWrapper</code> in <code class="highlighter-rouge">emukit.model_wrappers.gpy_model_wrappers</code> and wrap it.</p> <p>And that’s it! In the tutorials you can see how to train other available models like the one described in [<a href="#references-on-multi-fidelity-gaussian-processes">2</a>], which assumes a non-linear relationship between fidelities.</p> <p>Check our list of <a href="http://nbviewer.jupyter.org/github/amzn/emukit/blob/develop/notebooks/index.ipynb">notebooks</a> and <a href="https://github.com/amzn/emukit/tree/develop/emukit/examples">examples</a> if you want to learn more about how to do multi-fidelity emulation and other methods with Emukit. You can also check the Emukit <a href="https://emukit.readthedocs.io/en/latest/">documentation</a>.</p> <p>We’re always open to contributions! Please read our <a href="https://github.com/amzn/emukit/blob/develop/CONTRIBUTING.md">contribution guidelines</a> for more information. We are particularly interested in contributions regarding examples and tutorials.</p> <h4 id="references-on-muti-fidelity-emulation">References on Muti-fidelity emulation</h4> <ul> <li> <p>[1] Forrester, Alexander I.J., Sóbester, András and Keane, Andy J. (2007) <a href="https://eprints.soton.ac.uk/64698/">Multi-fidelity optimization via surrogate modelling</a>. <em>Proceedings of the Royal Society of London A</em>, 463 (2088), 3251-3269.</p> </li> <li> <p>[2] Kennedy, M.C. and O’Hagan, A., 2000. <a href="https://www.jstor.org/stable/2673557?seq=1#page_scan_tab_contents">Predicting the output from a complex computer code when fast approximations are available</a>. <em>Biometrika</em>, 87(1), pp.1-13.</p> </li> <li> <p>[3] Perdikaris, P., Raissi, M., Damianou, A., Lawrence, N.D. and Karniadakis, G.E., 2017. <a href="http://rspa.royalsocietypublishing.org/content/473/2198/20160751">Nonlinear information fusion algorithms for data-efficient multi-fidelity modelling</a>. <em>Proc. R. Soc. A</em>, 473(2198), p.20160751.</p> </li> </ul> </div> </article> <div class="row"> </div> <div class="row"> <ul class="pager"> <li><a class="next" href="/emukit/bayesian-optimization/">&laquo; Bayesian Optimization</a></li> <li><a class="previous" href="/emukit/experimental-design/">Experimental design &raquo;</a></li> </ul> </div> </div> <div class="col-md-4 mt20"> <div class="post-img"> <img width="600" src="/emukit/images/multi-fidelity.png" alt="Multi-fidelity emulation"> </div> <div class="mt10 recent"> <h2>Also in Emukit</h2> <ul> <li> <p><a href="/emukit/emukit-playground/">Emukit-playground</a></p> </li> <li> <p><a href="/emukit/bayesian-optimization/">Bayesian Optimization</a></p> </li> <li> <p><a href="/emukit/experimental-design/">Experimental design</a></p> </li> </ul> </div> </div> </div> </div> </div> <footer> <div class="container"> <div class="row p20"> <div class="col-md-4 text-center mt25"> <a target="_blank" href="http://twitter.com/@emukitUQ"><li class="social twitter"><i class="fa fa-twitter-square"></i></li></a> <a target="_blank" href="https://github.com/amzn/emukit"><li class="social github"><i class="fa fa-github-square"></i></li></a> </div> </div> </div> </footer> <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.2/jquery.min.js"></script> <script src="/emukit/js/bootstrap.min.js"></script> <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> </body> </html>
