<!DOCTYPE html> <html> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.5.0 --> <title>Sensitivity Analysis | Emukit</title> <meta name="generator" content="Jekyll v3.8.5" /> <meta property="og:title" content="Sensitivity Analysis" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Sensitivity analysis is the study of how the variations in the outputs of a system can be assigned to different sources of variation in its inputs." /> <meta property="og:description" content="Sensitivity analysis is the study of how the variations in the outputs of a system can be assigned to different sources of variation in its inputs." /> <link rel="canonical" href="http://localhost:4000/emukit/sensitivity-analysis/" /> <meta property="og:url" content="http://localhost:4000/emukit/sensitivity-analysis/" /> <meta property="og:site_name" content="Emukit" /> <meta property="og:type" content="article" /> <meta property="article:published_time" content="2016-05-07T00:00:00+01:00" /> <meta name="twitter:card" content="summary" /> <meta name="twitter:site" content="@" /> <script type="application/ld+json"> {"url":"http://localhost:4000/emukit/sensitivity-analysis/","dateModified":"2016-05-07T00:00:00+01:00","datePublished":"2016-05-07T00:00:00+01:00","headline":"Sensitivity Analysis","description":"Sensitivity analysis is the study of how the variations in the outputs of a system can be assigned to different sources of variation in its inputs.","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/emukit/sensitivity-analysis/"},"@type":"BlogPosting","@context":"http://schema.org"}</script> <!-- End Jekyll SEO tag --> <!-- <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"> --> <link rel="stylesheet" href="/emukit/css/main.css"> <link rel="alternate" type="application/rss+xml" title="Emukit" href="http://localhost:4000/emukit/feed.xml"> <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"> </head> <body> <header class="site-header"> <nav class="navbar navbar-default"> <div class="container-fluid"> <!-- Brand and toggle get grouped for better mobile display --> <div class="navbar-header"> <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button> <a class="navbar-brand" href="/emukit/">Emukit</a> </div> <!-- Collect the nav links, forms, and other content for toggling --> <div class="collapse navbar-collapse " id="bs-example-navbar-collapse-1"> <ul class="nav navbar-nav navbar-right"> <li><a href="/emukit/about/">About</a></li> <li><a href="http://nbviewer.jupyter.org/github/amzn/emukit/blob/develop/notebooks/index.ipynb">Tutorials</a></li> <li><a href="https://github.com/amzn/emukit/tree/develop/emukit/examples">Examples</a></li> <li class="dropdown"> <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Resources<span class="caret"></span></a> <ul class="dropdown-menu"> <li><a href="/emukit/installation/">Installation</a></li> <li role="separator" class="divider"></li> <li><a href="https://emukit.readthedocs.io/en/latest/">Documentation</a></li> <li><a href="https://emukit.readthedocs.io/en/latest/api/emukit.html">API reference</a></li> <li role="separator" class="divider"></li> <li><a href="/emukit/citation/">Citation</a></li> <li><a href="/emukit/news/">News</a></li> </ul> <li><a href="https://github.com/amzn/emukit">Github</a></li> </li> </ul> </div><!-- /.navbar-collapse --> </div><!-- /.container-fluid --> </nav> </header> <div class="container"> <div class="wrapper"> <div class="row"> <div class="col-md-8"> <article class="post" itemscope itemtype="http://schema.org/BlogPosting"> <header class="post-header"> <h1 class="post-title" itemprop="name headline">Sensitivity Analysis</h1> <p class="post-meta"></p> </header> <div class="post-content" itemprop="articleBody"> <p>Sensitivity analysis is the study of how the variations in the outputs of a system can be assigned to different sources of variation in its inputs.</p> <p>Understanding the variance of the outputs of a system in terms of the contributions of the inputs is a key aspect of uncertainty quantification: it helps to test the robustness of a system, design strategies for uncertainty reduction and helps to calibrate physical models to the real world by improving their interpretability.</p> <p>Sensitivity analysis methods are divided into two main classes: <em>local</em> methods, where changes in the output are studied for specific values of the inputs, and <em>global</em> methods where the total variability of the outputs is assigned to each input variable. Given a physical model of a system, for instance a climate model simulator, local sensitivity analysis is carried out using gradients. However, if the physical model is expensive-to-evaluate approximating gradients becomes intractable. Using an emulator of the physical model, like a Gaussian process, and using its analytic gradients is an effective alternative.</p> <p>A similar situation arises when doing global sensitivity analysis. The core element in global sensitivity analysis are the Sobol indices, also called <em>main effects</em> [<a href="#references-on-sensitivity-analysis">1,2</a>]. They are a measure of “first order sensitivity” of each input variable. They account for the proportion of variance of the output explained by changing each variable alone while marginalizing over the rest. The <em>total effects</em> are also common [<a href="#references-on-sensitivity-analysis">3</a>]. They account for the contribution to the output variance of each variable but including all variance caused by the variable alone and all its interactions of any order of the inputs. Both indices can be easily computed in Emukit.</p> <p>To illustrate how to do global sensitivity analysis of a simulator we use the <a href="https://www.sfu.ca/~ssurjano/ishigami.html">Ishigami function</a>. This function has three continuous inputs and depends on two parameters that we fix in this example.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">emukit.test_functions.sensitivity</span> <span class="kn">import</span> <span class="n">Ishigami</span>

<span class="n">ishigami</span> <span class="o">=</span> <span class="n">Ishigami</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">target_simulator</span> <span class="o">=</span> <span class="n">ishigami</span><span class="o">.</span><span class="n">fidelity1</span>
</code></pre></div></div> <p>Emukit allows to compute both the main and total effects using Monte Carlo with the Saltelli estimators [<a href="#references-on-sensitivity-analysis">4</a>]. Instead of computing the indices by calling the simulator, we learn an emulator first and we compute the indices using <em>cheap</em> calls to this model. We first define the parameter space:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">from</span> <span class="nn">emukit.core</span> <span class="kn">import</span> <span class="n">ContinuousParameter</span><span class="p">,</span> <span class="n">ParameterSpace</span>

<span class="n">space</span> <span class="o">=</span> <span class="n">ParameterSpace</span><span class="p">([</span><span class="n">ContinuousParameter</span><span class="p">(</span><span class="s">'x1'</span><span class="p">,</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">),</span>
                        <span class="n">ContinuousParameter</span><span class="p">(</span><span class="s">'x2'</span><span class="p">,</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">),</span>
                        <span class="n">ContinuousParameter</span><span class="p">(</span><span class="s">'x3'</span><span class="p">,</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)])</span>
</code></pre></div></div> <p>Now we generate a data set by evaluating the simulator on 500 random samples in the input domain:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">emukit.experimental_design.model_free.random_design</span> <span class="kn">import</span> <span class="n">RandomDesign</span>
<span class="n">desing</span> <span class="o">=</span> <span class="n">RandomDesign</span><span class="p">(</span><span class="n">space</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">desing</span><span class="o">.</span><span class="n">get_samples</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span>
<span class="n">Y</span>  <span class="o">=</span> <span class="n">ishigami</span><span class="o">.</span><span class="n">target_simulator</span><span class="p">(</span><span class="n">X</span><span class="p">)[:,</span><span class="bp">None</span><span class="p">]</span>
</code></pre></div></div> <p>And we wrap and fit a Gaussian process to the inputs and outputs of the simulator.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">GPy.models</span> <span class="kn">import</span> <span class="n">GPRegression</span>
<span class="kn">from</span> <span class="nn">emukit.model_wrappers</span> <span class="kn">import</span> <span class="n">GPyModelWrapper</span>

<span class="n">model_gpy</span> <span class="o">=</span> <span class="n">GPRegression</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">)</span>
<span class="n">model_emukit</span> <span class="o">=</span> <span class="n">GPyModelWrapper</span><span class="p">(</span><span class="n">model_gpy</span><span class="p">)</span>
<span class="n">model_emukit</span><span class="o">.</span><span class="n">optimize</span><span class="p">()</span>
</code></pre></div></div> <p>We are now ready to compute the sensitivity indices. It is as simple as running:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">emukit.sensitivity.monte_carlo</span> <span class="kn">import</span> <span class="n">MonteCarloSensitivity</span>

<span class="n">senstivity</span> <span class="o">=</span> <span class="n">MonteCarloSensitivity</span><span class="p">(</span><span class="n">model</span> <span class="o">=</span> <span class="n">model_emukit</span><span class="p">,</span> <span class="n">input_domain</span> <span class="o">=</span> <span class="n">space</span><span class="p">)</span>
<span class="n">main_effects</span><span class="p">,</span> <span class="n">total_effects</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">senstivity</span><span class="o">.</span><span class="n">compute_effects</span><span class="p">(</span><span class="n">num_monte_carlo_points</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">)</span>
</code></pre></div></div> <p>And that’s it! You can check the computed main and total effects. Note that although we have used a Gaussian process here, the coefficients are computed running Monte Carlo, which means that any model can be wrapped here.</p> <p>Check our list of <a href="http://nbviewer.jupyter.org/github/amzn/emukit/blob/develop/notebooks/index.ipynb">notebooks</a> and <a href="https://github.com/amzn/emukit/tree/develop/emukit/examples">examples</a> if you want to learn more about how to do sensitivity analysis and other methods with Emukit. You can also check the Emukit <a href="https://emukit.readthedocs.io/en/latest/">documentation</a>.</p> <p>We’re always open to contributions! Please read our <a href="https://github.com/amzn/emukit/blob/develop/CONTRIBUTING.md">contribution guidelines</a> for more information. We are particularly interested in contributions regarding examples and tutorials.</p> <h4 id="references-on-sensitivity-analysis">References on sensitivity analysis</h4> <ul> <li>[1] Sobol, I. M. (2001), <a href="https://www.sciencedirect.com/science/article/abs/pii/S0378475400002706">Global sensitivity indices for nonlinear mathematical models and their Monte Carlo estimates</a>. <em>Math Comput. Simulat.</em>, 55(1–3),271-280, 2001</li> <li>[2] Sobol’, I. M (1990). <a href="http://max2.ese.u-psud.fr/epc/conservation/MODE/Sobol%20Original%20Paper.pdf">Sensitivity estimates for nonlinear mathematical models</a>. <em>Matematicheskoe Modelirovanie</em> 2, 112–118. in Russian, translated in English in Sobol’ , I., 2001.</li> <li>[3] Andrea Saltelli, Paola Annoni, Ivano Azzini, Francesca Campolongo, Marco Ratto, and Stefano Tarantola. (2010) <a href="https://www.sciencedirect.com/science/article/pii/S0010465509003087">Variance based sensitivity analysis of model output</a>. Design and estimator for the total sensitivity index. <em>Computer Physics Communications</em>, 181(2):259-270, 2010.</li> <li>[4] Kennedy, M.C. and O’Hagan, A., (2000). <a href="https://www.jstor.org/stable/2673557">Predicting the output from a complex computer code when fast approximations are available</a>. <em>Biometrika</em>, 87(1), pp.1-13, 2000.</li> </ul> </div> </article> <div class="row"> </div> <div class="row"> <ul class="pager"> <li><a class="next" href="/emukit/bayesian-quadrature/">&laquo; Bayesian Quadrature</a></li> </ul> </div> </div> <div class="col-md-4 mt20"> <div class="post-img"> <img width="600" src="/emukit/images/sensitivity.png" alt="Sensitivity Analysis"> </div> <div class="mt10 recent"> <h2>Also in Emukit</h2> <ul> <li> <p><a href="/emukit/emukit-playground/">Emukit-playground</a></p> </li> <li> <p><a href="/emukit/bayesian-optimization/">Bayesian Optimization</a></p> </li> <li> <p><a href="/emukit/multifidelity-emulation/">Multi-fidelity emulation</a></p> </li> </ul> </div> </div> </div> </div> </div> <footer> <div class="container"> <div class="row p20"> <div class="col-md-4 text-center mt25"> <a target="_blank" href="http://twitter.com/@emukitUQ"><li class="social twitter"><i class="fa fa-twitter-square"></i></li></a> <a target="_blank" href="https://github.com/amzn/emukit"><li class="social github"><i class="fa fa-github-square"></i></li></a> </div> </div> </div> </footer> <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.2/jquery.min.js"></script> <script src="/emukit/js/bootstrap.min.js"></script> <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> </body> </html>
